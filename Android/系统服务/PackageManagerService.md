## Q1: 什么是 PMS

PMS 是 Android 系统中的 Package Manager Service，主要负责应用的安装、卸载、权限控制等操作，是 Android 系统中非常重要的一个服务。

## Q2：Android 应用的安装过程是怎样的？

1. 用户点击安装包或从应用商店下载并安装应用。

2. 系统将应用安装包发送给 PMS。

3. 将安装包拷贝到/data/app下。
   
4. 检查当前安装包的状态，确保安装环境正常。

5. 解压应用包，并将应用数据、资源、代码等分别保存到不同的目录下。

6. 解析AndroidManifest.xml文件，验证应用是否具有正确的签名，并设置应用的权限等信息。

7. dex2oat操作，将apk中的dex文件转换为oat文件。

8. 将AndroidManifest文件解析出的组件、权限注册到PackageManagerService

9. 发送安装完成广播。

## Q3：Android 应用的卸载过程是怎样的？

1. 用户点击应用的卸载按钮或通过应用商店进行卸载。

2. 系统将卸载请求发送到 PMS。

3. PMS 停止应用的运行，并删除应用的数据、资源、代码等文件。

4. PMS 更新应用列表，将已卸载的应用从系统中移除。

5. 发送卸载广播。

## Q4：PMS 中的权限控制是怎样实现的？

PMS 中的权限控制通过权限管理和权限请求两个方面来实现。应用在 Android 系统中需要声明和请求权限，PMS 则会根据应用声明的权限和用户的选择来进行权限的管理和控制。

## Q5：如何获取已安装应用的信息？

可以通过 PMS 提供的 PackageManager API 来获取已安装应用的信息，比如应用的名称、版本号、图标等。例如，可以通过以下代码获取所有已安装应用的 PackageInfo 信息：

PackageManager pm = context.getPackageManager();

List packages = pm.getInstalledPackages(0);

## Q6：如何安装非公开应用？

非公开应用需要用户手动打开“允许安装来自未知来源的应用”选项才能安装，这可以在系统设置的“安全”选项中进行设置。再次安装应用时，系统会提示用户是否允许非公开应用的安装，并让用户选择是否启用“未知来源”的应用进行安装。
