## 内存问题表现形式

内存溢出(out of memory):是指程序在申请内存时，没有足够的内存空间供其使用。

内存泄漏(memory leak):是指程序在申请内存后，无法释放已申请的内存空间，一次内存泄漏危害可以忽略，但内存泄漏堆积后果很严重，无论多少内存，迟早会被占光。表现：可用内存逐渐减少、频繁GC。

memory leak最终会导致out of memory。 

内存抖动(Memory Churn)：在程序需要对象的时候，在堆当中分配出来一块空间，使用完毕以后， GC 帮我们清理掉这片内存空间,如果频繁的一直持续上述操作，就会引起内存抖动。表现：锯齿状、GC频繁导致卡顿。

## OutOfMemoryError

### 原因：

1. Java堆内存溢出

2. 无足够连续内存空间

3. fd数量超出限制（1024，ulimit -a查看）

4. 线程数量超出限制（1024）

5. 虚拟内存不足（使用多进程，如大图片放到一个单独的进程）

/system/build.prop文件中：dalvik.vm.heapstartsize是app启动的初始分配内存，dalvik.vm.heapgrowthlimit是app最大内存限制，dalvik.vm.heapsize是开启largeHeap="true"的最大内存限制。

## memory leak

### 原因：

1. 单例造成的内存泄漏（创建单例时不能使用Activity的Context，要使用Application的Context）

2. 非静态内部类创建静态实例造成的内存泄漏（使用静态内部类）
  
3. handler造成的内存泄漏（将Handler声明为静态的，通过弱引用持有Activity）

4. 线程造成的内存泄漏（使用静态内部类）
        
5. webview造成的内存泄漏（单独放一个进程，用完后killProcess）
